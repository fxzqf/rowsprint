<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>批量套打</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            margin: 50;
        }

        iframe {
            display: block;
            border: none;
            height: 100vh;
            width: 100vw;
        }

        p {
            text-indent: 2ch;
        }

        .container {
            margin-left: auto;
            margin-right: auto;
            width: 680px;
        }
    </style>
    <script src="./js/wpsjsrpcsdk.js"></script>
</head>

<body>
    <div class="container">
        <H2>批量套打使用说明</H2>
        <p>
            使用批量套打可以使用同一个模板，把一个工作表中的多行数据进行分页打印。
        </p>
        <h3>第一步</h3>

        <button onclick="startWps()">启用批量套打</button>
        <script>
            function startWps(){
                var element = { "name": "wpsapp", "addonType": "et", "online": "true", "multiUser": "false", "url": "https://fxzqf.github.io/wpsapp/" };
                var installed = false;
                WpsAddonMgr.getAllConfig(function (e) {
                    if (!e.response || e.response.indexOf("null") >= 0) { }
                    else {
                        JSON.parse(e.response).forEach(e1 => {
                            if (e1.url = element.rul) installed = true;
                        });
                    }
                });
                if (!installed) {
                    WpsAddonMgr.disable(element);
                    WpsAddonMgr.enable(element);
                }
                WpsInvoke.InvokeAsHttp(WpsInvoke.ClientType.et, "wpsapp", "showTaskPane", JSON.stringify({ url: "rowsprint", name: "批量套打" }));
            }
        </script>
    </div>
</body>

</html>